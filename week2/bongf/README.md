
작성 코드 : https://github.com/bong6981/toby-spring/commits/vol1-week2 커밋 a04aabca1907c6619b482026a1ee68af6d8d0727 부터 

# 1. 학습내용
## 1. 오브젝트 팩토리로의 분리
-	사용할 오브젝트를 생성하고 관계를 맺어주는 기능을 팩토리로(오브젝트 팩토리, DaoFactory.class) 분리했다
-	분리한 팩토리 DaoFactory는 애플리케이션 구성하는 컴포넌트의 구조와 관계를 정의하는 설계도로서의 역할을 한다 
-	애플리케이션 컴포넌트의 역할을 하는 오브젝트랑 애플리케이션의 구조를 결정하는 오브젝트를 분리했다는데 의의

## 2. DaoFactory 리팩토링
-	다른 Dao를 생성할 때도 DaoFactory를 사용할 수 있도록 메소드를 분리했다. (connectionMaker())
-	connection을 생성해주는 connectionMaker()를 분리하여 다른 Dao를 생성할 때도 이 메소드를 사용할 수 있게 하여 중복을 방지하고 ConnectionMaker 구현체가 중복 생성되는 것을 막을 수 있다(싱글톤을 사용하면)

## 3. 오브젝트 팩토리를 통해 학습한 제어의 역전
-	DaoFactory를 분리하면서 UserDao는 ConnectionMaker의 구현체를 사용함에도 불구하고 어떤 구현체를 사용할지 결정하지도 못하도 그 구현체를 생성하지도 않게 되었다 
-	일반적인 프로그램의 제어 흐름은 사용하는 쪽에서 제어권을 갖는 것이다. 자신이 사용할 클래스를 결정하고 언제 어떻게 그 오브젝트를 만들지 결정하는 것
-	제어의 역전은 그 흐름을 뒤집는 것이다. 
	-	자신이 사용할 오브젝트를 선택도 안하고 생성도 못한다 
    -	자기 자신조차 어디서 사용되고 어떻게 만들어지 알 수 없다. 
    -	모든 제어의 흐름을 자신이 아닌 다른 대상에게 위임하는 것이다. 
-	DaoFacotry.class로 분리하면서 제어의 역전이 일어난 것
-	제어의 역전은 폭넓게 적용되어 있다 (프레임워크에 한정된 개념이아니다)
	-	서블릿을 개발자가 개발할 수는 있지만 그 생성과 실행은 개발자가 할 수 없다. 그 외 디자인 패턴 등에도 적용되어 있다 
    -	스프링은 IoC를 극한까지 적용하고 있는 프레임워크 

## 4. 스프링의 애플리케이션 컨텍스트를 사용한 제어의 역전 
-	DaoFactory에 @Configuration 어노테이션 을 붙이고 UserDao를 생성하는 메서드인 userDao에 @Bean을 붙인다
-	그리고 UserDao 오브젝트를 호출하는 UserDaoTest에서 DaoFactory를 설정보를 넣어서 생성한 ApplicationContext의 구현체에서 getBean()메소드를 통해 userDao객체를 생성한다. 
-	이것이 스프링 컨테이너에 DaoFactory의 설정정보로 어플리케이션 컨텍스트를 만들어 UserDao를 빈(스프링 컨테이너가 제어권을 갖고 직접 만들과 관계를 부여하는 오브젝트)으로 등록하고 이 생성과 관리를 스프링 컨테이너가 하게 만든 것이다. 

### 애플리케이션 컨텍스트의 작동 방식 
-	애플리케이션 컨텍스트는 DaoFactory 클래스를 설정정보로 등록해두고 @Bean이 붙은 메소드의 이름을 가져와 빈 목록을 만들어둔다
-	클라이언트가 애플리케이션 컨텍스트의 getBean() 메소드를 호출하면 자신의 빈 목록에서 요청한 이름이 있는지 찾고 있다면 빈을 생성하는 메서드를 호출해서 오브젝트를 생성시킨 후 클라이언트에 돌려준다


### 애플리케이션 컨텍스트를 사용한 방식과 오브젝트 팩토리를 사용한 방식의 비교 
-	DaoFactory로도 충분히 할 수 있던 내용을 스프링이 관리하게 해서 얻는 이점은?	
-	클라이언트는 구체적인 팩토리 클래스를 알 필요가 없다.
	-	여러 팩토리 클래스가 있다고 한다면 이를 각각 알 필요가 없다. ApplicationContext에 등록되어 있을 것이기 때문
    -	애플리케이션 컨텍스트의 역할은 단지 오브젝트 생성과 다른 오브젝트와의 관계 설정 뿐 아니라 다양한 기능 제공
    -	애플리케이션 컨텍스트는 빈을 검색하는 다양한 방법을 제공한다. getBean() 메소드로 빈 이름으로 조회도 가능하고, 해당 클래스를 갖는 모든 빈을 찾을 수도 있다

### 가장 중요한 차이는 애플리케이션 컨텍스트를 사용하면 싱글톤이 보장된다는 것이다 
-	애플리케이션 컨텍스트는 싱글톤을 저장하고 관리하는 싱글톤 레지스트리 이기도 하다. 스프링은 기본적으로 별다른 설정 안하면 내부에서 생성하는 빈 오브젝트를 모두 싱글톤으로 만든다.
-	왜 싱글톤으로 빈을 만들까?
	-	스프링이 주로 적용되는 대상이 자바 엔터프라이즈 기술을 사용하는 서버환경(대규모, 복잡)이기 때문에 요청마다 각 로직에 맞는 오브젝트 만들면 서버 부하 거리기 때문에 싱글톤의 상요이 권장되기 때문이다.
-	그런데 자바 코드로 구현한 싱글톤 패턴은 단점이 많다. 코드가 지저분해주고 테스트가 불편해지고 객제지향적 설계에 바탕을 둔(상속, 다형성 활용) 객체를 만들지 못한다. 또 서버환경에서는 싱글톤이 보장된다고도 할 수 없다. (?클래스 로더를 어떻게 구성하냐에 따라서 하나 이상의 오브젝트가 만들어 질 수 있다). 또한 static 메소드 이용해서 언제 어디서든지 접근 가능한 전역 상태를 만들 수 있기 때문에 바람직하지 못하다. 
-	스프링 컨테이너는 평범한 자바 클래스를 싱글톤으로 활용하게 해준다. 오브젝트 생성에 관한 모든 권한이 어플리케이션 컨텍스트에 있기 때문이다. 그렇기 때문에 기존 싱글톤 패턴이 가진 단점을 모두 해결하면서도 싱글톤으로 관리할 수 있다.
-	그럼에도 한가지는 스프링이 관리하는 빈으로 등록되면 싱글톤으로 되기 때문에 stateless 방식으로 만들어져야 한다(상태없음. 읽기전용은 제외)
	-	파라미터, 로컬변수, 리턴 값등을 적극적으로 활용하라 
-	이렇게 만들어진 스프링 빈의 스코프는 기본적으로 싱글톤(스프링컨테이너가존재하는동안유지)이지만 prototype(컨테이너에 빈을 요청할 때마다 생성), request(http요청이 생길 때마다 생성),  session(웹의 세션과유사)하는 다양한 스코프를 옵션을 줘서 사용가능하다


# 2. 기타 배울 수 있던
## 팩토리
-	factory
-	객체 생성 방법을 결정하고 그렇게 생성된 오브젝트를 돌려주는 일을 하는 오브젝트를 factory라고 부른다 
-	오브젝트를 생성하는 쪽과 사용하는 쪽의 역할과 책임을 분리하려는 목적으로 사용한다 (어떻게 만들지와 어떻게 사용할지의 구분)
![](https://images.velog.io/images/bongf/post/d32a261c-cab6-42a1-9a7d-34126e9aa61f/image.png)
## 라이브러리와 프레임워크의 차이
-	라이브러리를 사용하는 애플리케이션 코드는 애플리케이션 흐름을 직접 제어한다. 동작하는 중에 필요할 때 능동적으로 라이브러리 사용한다 
-	프레임워크는 애플리케이션 코드가 그 프레임워크에 의해 사용된다. (제어의 역전)

## 스프링 IoC 용어 정리 : 빈, 빈팩토리, 애플리케이션컨텍스트, 설정정보, 컨테이너, 스프링 
### 빈 Bean
-	스프링이 IoC 방식으로 관리하는 오브젝트라는 뜻
-	스프링을 사용하는 애플리케이션에서 만들어지는 모든 오브젝트가 빈은 아니다. 그 중에서 스프링이 직접 생성과 제어를 담당하는 오브젝트만을 빈이라고 부란다 
### 빈 팩토리 BeanFactory
-	스프링의 IoC를 담당하는 핵심 컨테이너
-	빈을 등록, 생성, 조회, 돌려주고 그외에 부가적인 빈을 관리하는 기능을 담당
-	보통은 이 빈팩토리를 바로 사용하지 않고 이를 확장한 애플리케이션 컨텍스트를 이용
-	BeanFactory라고 붙여쓰면 빈 팩토리가 구현하고 있는 가장 기본적인 인터페이스의 이름이 된다. 이 인터페이스 getBean() 과 같은 메소드가 정의되어 있다. 
### 애플리케이션 컨텍스트 Application Context
-	빈팩토리를 확장한 IoC 컨테이너
-	빈을 등록하고 관리하는 기본적인 기능을 빈팩토리와 동일
-	여기에 스프링이 제공하는 각종 부가 서비스를 추가로 제공
-	빈 팩토리라고 부를 때는 빈의 생성과 제어의 관점에서 얘기하는 것이고 애플리케이션 컨텍스트라고 할 때는 스프링이 제공하는 애플리케이션 지원 기능을 모두 포함해서 이야기 하는 것
-	스프링에서는 애플리케이션 컨텍스트라는 용어를 빈 팩토리보다 많이 사용
-	Application Context라 적으면 애플리케이션 컨텍스트가 구현해야 하는 기본 인터페이스를 가리키는 것이기도 하다 
	-	Application Context는 BeanFactory를 상속
### 설정정보/설정 메타정보 Configuration metadata
-	스프링의 설정정보란 애플리케이션 컨텍스트 또는 빈 팩토리가 IoC를 적용하기 위해 사용하는 메타 정보를 말한다 
-	실제로 스프링의 설정정보는 컨테이너에 어떤 기능을 세팅, 조정하는데도 쓰이지만 그보다는 IoC 컨테이너에 의해 관리되는 애플리케이션 오브젝트를 생성하고 구성할 때 사용된다 

### 컨테이너container 또는 IoC 컨테이너
-	IoC 방식으로 빈을 관리한다는 의미에서 애플리케이션 컨텍스트나 빈 팩토리 컨테이너, 또는 IoC 컨테이너라부르기도 한다. 
-	그냥 컨테이너 또는 스프링 컨테이너라고 할 때는 애플리케이션 컨텍스트를 가리키는 것이라고 보면 된다
-	컨테이너란 말은 애플리케이션 컨텍스트보다는 추상적인 표현이기도 하다 
	-	애플리케이션 컨텍스트는 ApplicationContext 인터페이스를 구현한 오브젝트를 가리키기도 한는데 애플리케이션 컨텍스트는 오브젝트는 하나의 애플리케이션에서 보통 여러 개가 만들어져 사용된다. 이를 통틀어서 스프링 컨테이라고 부를 수 있다 
-	때로는 컨테이너라는 말을 떼고 스프링이라고 부를 때도 바로 이 스프링 컨테이너를 가리키는 것일 수 있다. 예를 들어 '스프링에 빈을 등록하고' 라는 식으로 말하는 경우에 스프링은 스프링 컨테이너 또는 애플리케이션 컨텍스트를 가리키는 말이다
### 스프링 프레임워크
-	스프링 프레임워크는 IoC 컨테이너, 애플리케이션 컨텍스틀르 포함해서 스프링이 제공하는 모든 기능을 통틀어 말할 때 주로 사용한다 
-	그냥 스프링이라고 줄여서 말하기도 한다 

## 3. 로빈 트리에게 질문
-	싱글톤 패턴의 한계에서 (?클래스 로더를 어떻게 구성하냐에 따라서 하나 이상의 오브젝트가 만들어 질 수 있다)
